<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>MCTF2021 - Android - adminPanel | kik0uO7</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="MCTF2021 - Android - adminPanel" />
<meta name="author" content="kik0uO7" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="MidnightflagCTF2021 Organisé par l’ESN’hack. La CTF c’est déroulée la nuit du 10/04/21 au 11/04/21. Grâce à ABH le pro de l’OSINT, on termine dans le TOP 10 du classement général. TL;DR Ce post est dédié à la résolution du challenge AdminPanel. Basiquement pas besoin d’installer l’application des outils décompilant les apk sont nombreux. Voilà ma démarche de réfléxion pour résoudre ce challenge. Décompilation via jadx-gui Compréhension de l’algo et identification du problème Implémentation en python Task Un lycéen a créé une application où seulement un seul utilisateur peut se connecter, et il a implémenté une vérification “maison”. Curieux, vous avez récupéré l’application, pour voir si vous pouvez vous connecter ! adminPanel.apk Décompilation La décompilation se fait facilement avec jadx La classe fr.whimsickle.adminpanel.data.LoginDataSource contient les éléments permettant de dériver le mot de passe. Compréhension de l’algorithme L’algorithme de vérification du mot de passe est extrêmement simple, il prend juste le vrai mot de passe l’inverse et le met en hexadécimale Implémentation pwd = &quot;3476614A6465357265566552743347&quot; rev_pwd = bytes.fromhex(pwd)[::-1].decode() print(&quot;MCTF{&quot; + rev_pwd + &quot;}&quot;) Flag MCTF{G3tReVer5edJav4}" />
<meta property="og:description" content="MidnightflagCTF2021 Organisé par l’ESN’hack. La CTF c’est déroulée la nuit du 10/04/21 au 11/04/21. Grâce à ABH le pro de l’OSINT, on termine dans le TOP 10 du classement général. TL;DR Ce post est dédié à la résolution du challenge AdminPanel. Basiquement pas besoin d’installer l’application des outils décompilant les apk sont nombreux. Voilà ma démarche de réfléxion pour résoudre ce challenge. Décompilation via jadx-gui Compréhension de l’algo et identification du problème Implémentation en python Task Un lycéen a créé une application où seulement un seul utilisateur peut se connecter, et il a implémenté une vérification “maison”. Curieux, vous avez récupéré l’application, pour voir si vous pouvez vous connecter ! adminPanel.apk Décompilation La décompilation se fait facilement avec jadx La classe fr.whimsickle.adminpanel.data.LoginDataSource contient les éléments permettant de dériver le mot de passe. Compréhension de l’algorithme L’algorithme de vérification du mot de passe est extrêmement simple, il prend juste le vrai mot de passe l’inverse et le met en hexadécimale Implémentation pwd = &quot;3476614A6465357265566552743347&quot; rev_pwd = bytes.fromhex(pwd)[::-1].decode() print(&quot;MCTF{&quot; + rev_pwd + &quot;}&quot;) Flag MCTF{G3tReVer5edJav4}" />
<link rel="canonical" href="http://localhost:4000/mctf2021_adminpanel" />
<meta property="og:url" content="http://localhost:4000/mctf2021_adminpanel" />
<meta property="og:site_name" content="kik0uO7" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-04-11T20:55:43+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="MCTF2021 - Android - adminPanel" />
<script type="application/ld+json">
{"url":"http://localhost:4000/mctf2021_adminpanel","headline":"MCTF2021 - Android - adminPanel","dateModified":"2021-04-11T20:55:43+02:00","datePublished":"2021-04-11T20:55:43+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/mctf2021_adminpanel"},"description":"MidnightflagCTF2021 Organisé par l’ESN’hack. La CTF c’est déroulée la nuit du 10/04/21 au 11/04/21. Grâce à ABH le pro de l’OSINT, on termine dans le TOP 10 du classement général. TL;DR Ce post est dédié à la résolution du challenge AdminPanel. Basiquement pas besoin d’installer l’application des outils décompilant les apk sont nombreux. Voilà ma démarche de réfléxion pour résoudre ce challenge. Décompilation via jadx-gui Compréhension de l’algo et identification du problème Implémentation en python Task Un lycéen a créé une application où seulement un seul utilisateur peut se connecter, et il a implémenté une vérification “maison”. Curieux, vous avez récupéré l’application, pour voir si vous pouvez vous connecter ! adminPanel.apk Décompilation La décompilation se fait facilement avec jadx La classe fr.whimsickle.adminpanel.data.LoginDataSource contient les éléments permettant de dériver le mot de passe. Compréhension de l’algorithme L’algorithme de vérification du mot de passe est extrêmement simple, il prend juste le vrai mot de passe l’inverse et le met en hexadécimale Implémentation pwd = &quot;3476614A6465357265566552743347&quot; rev_pwd = bytes.fromhex(pwd)[::-1].decode() print(&quot;MCTF{&quot; + rev_pwd + &quot;}&quot;) Flag MCTF{G3tReVer5edJav4}","@type":"BlogPosting","author":{"@type":"Person","name":"kik0uO7"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="kik0uO7" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">kik0uO7</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/posts/">Related posts</a><a class="page-link" href="/tags/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">MCTF2021 - Android - adminPanel</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-04-11T20:55:43+02:00" itemprop="datePublished">
        Apr 11, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">kik0uO7</span></span></p>
      
      
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="midnightflagctf2021">MidnightflagCTF2021</h1>
<p>Organisé par l’ESN’hack. La CTF c’est déroulée la nuit du 10/04/21 au 11/04/21.
Grâce à <a href="https://www.abhw0rld.com/">ABH</a> le pro de l’OSINT, on termine dans le TOP 10 du classement général.</p>

<p><img src="assets/ctf/MCTF2021/scoreboard.png" alt="scoreboard" /></p>

<h1 id="tldr">TL;DR</h1>
<p>Ce post est dédié à la résolution du challenge <strong>AdminPanel</strong>.</p>

<p>Basiquement pas besoin d’installer l’application des outils décompilant les apk sont nombreux.<br />
Voilà ma démarche de réfléxion pour résoudre ce challenge.</p>

<ol>
  <li>Décompilation via <code class="language-plaintext highlighter-rouge">jadx-gui</code></li>
  <li>Compréhension de l’algo et identification du problème</li>
  <li>Implémentation en python</li>
</ol>

<h1 id="task">Task</h1>
<p>Un lycéen a créé une application où seulement un seul utilisateur peut se connecter, et il a implémenté une vérification “maison”.</p>

<p>Curieux, vous avez récupéré l’application, pour voir si vous pouvez vous connecter !</p>

<p><a href="https://ctf.midnightflag.fr/files/4d7cacbae7b9808c300a79efd2d5e3cb/adminPanel.apk?token=eyJ1c2VyX2lkIjoxNSwidGVhbV9pZCI6NSwiZmlsZV9pZCI6Njd9.YHM_bQ.kt-gDsY2bzNd9y_HUkd9n4TBIow">adminPanel.apk</a></p>

<h1 id="décompilation">Décompilation</h1>
<p>La décompilation se fait facilement avec jadx</p>

<p>La classe <code class="language-plaintext highlighter-rouge">fr.whimsickle.adminpanel.data.LoginDataSource</code> contient les éléments permettant de dériver le mot de passe.</p>

<p><img src="assets/ctf/MCTF2021/jadx-gui_adminpanel_login_data_source.png" alt="jadx-gui_adminpanel_login_data_source" /></p>

<h1 id="compréhension-de-lalgorithme">Compréhension de l’algorithme</h1>
<p>L’algorithme de vérification du mot de passe est extrêmement simple, il prend juste le vrai mot de passe l’inverse et le met en hexadécimale</p>

<h1 id="implémentation">Implémentation</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pwd</span> <span class="o">=</span> <span class="s">"3476614A6465357265566552743347"</span>
<span class="n">rev_pwd</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">pwd</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">decode</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s">"MCTF{"</span> <span class="o">+</span> <span class="n">rev_pwd</span> <span class="o">+</span> <span class="s">"}"</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="flag">Flag</h1>
<p><code class="language-plaintext highlighter-rouge">MCTF{G3tReVer5edJav4}</code></p>

  </div><a class="u-url" href="/mctf2021_adminpanel" hidden></a>
</article>
      </div>
    </main><!-- ici y'aura peut être des trucs --></body>

</html>
